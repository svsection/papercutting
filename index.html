<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PDF Finder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    
    body { font-family: Arial, sans-serif; padding: 24px; max-width: 720px; margin: 0 auto; }
    h1 { margin-bottom: 12px; }
    .row { display: flex; gap: 8px; align-items: center; }
    input { padding: 10px; font-size: 16px; width: 260px; }
    button { padding: 10px 14px; font-size: 16px; cursor: pointer; }
    #status { margin-top: 8px; font-size: 14px; color: #555; }
    #result { margin-top: 18px; }
    .link { display: block; margin: 8px 0; }
    .error { color: #b00020; }
    .muted { color: #666; font-size: 14px; }
    .marquee {width: 100%; overflow: hidden; white-space: nowrap; box-sizing: border-box; animation: scroll 10s linear infinite;}
    @keyframes scroll {
  0% { transform: translateX(100%); }
  100% { transform: translateX(-100%); }
      
  </style>
</head>
<body>



<div class="marquee">
  You Can Download Paper Cutting till Tender Notice No. S-55-2025.
</div>

  
  <h1>Download Paper Cutting by 8-digit Tender Number</h1>
  <div class="row">
    <input id="searchBox" type="text" inputmode="numeric" maxlength="8" placeholder="Enter 8-digit number" />
    <button id="searchBtn">Search</button>
  </div>
  <div id="status" class="muted">Loading indexâ€¦</div>
  <div id="result"></div>










  
  <script>
    // Reverse index: "12345678" -> Set([ "Paper Cutting S-01-2025.pdf", ... ])
    const reverseIndex = new Map();
    let indexReady = false;

    // Helper: make sure values from JSON become 8-char digit strings
    function toEightDigitString(n) {
      if (n === null || n === undefined) return null;
      let s = String(n).trim();         // handle numbers or strings
      s = s.replace(/\D/g, "");         // keep digits only
      if (s.length === 0) return null;
      if (s.length > 8) return null;    // ignore anything that's not exactly 8 digits
      if (s.length < 8) s = s.padStart(8, "0");
      return /^\d{8}$/.test(s) ? s : null;
    }

    function buildReverseIndex(indexData) {
      for (const [file, nums] of Object.entries(indexData)) {
        if (!Array.isArray(nums)) continue;
        for (const n of nums) {
          const key = toEightDigitString(n);
          if (!key) continue;
          if (!reverseIndex.has(key)) reverseIndex.set(key, new Set());
          reverseIndex.get(key).add(file);
        }
      }
    }

    async function loadIndex() {
      const status = document.getElementById("status");
      try {
        const res = await fetch("index.json", { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        buildReverseIndex(data);
        indexReady = true;
        status.textContent = "Welcome, Have a good day...";
      } catch (e) {
        indexReady = false;
        status.innerHTML = `<span class="error">Couldn't load index.json (${e.message}).</span>`;
      }
    }

    function search() {
      const resultDiv = document.getElementById("result");
      const status = document.getElementById("status");
      const query = document.getElementById("searchBox").value.trim();

      resultDiv.innerHTML = "";

      if (!indexReady) {
        status.innerHTML = `<span class="error">Index not ready yet. Please wait a moment.</span>`;
        return;
      }

      if (!/^\d{8}$/.test(query)) {
        resultDiv.innerHTML = `<p class="error">Please enter a valid 8-digit number.</p>`;
        return;
      }

      const filesSet = reverseIndex.get(query);
      if (filesSet && filesSet.size > 0) {
        const files = Array.from(filesSet).sort((a, b) => a.localeCompare(b, undefined, { numeric: true }));
        const header = document.createElement("p");
        header.textContent = `Found in ${files.length} PDF${files.length > 1 ? "s" : ""}:`;
        resultDiv.appendChild(header);

        for (const pdf of files) {
          const a = document.createElement("a");
          a.className = "link";
          a.href = "pdfs/" + encodeURIComponent(pdf); // handle spaces & special chars
          a.target = "_blank";
          a.download = pdf;
          a.textContent = pdf; // show actual filename
          resultDiv.appendChild(a);
        }
      } else {
        resultDiv.innerHTML = `<p class="error">Paper Cutting Yet to be received in SV Section</p>`;
      }
    }

    // Wire up UI
    document.getElementById("searchBtn").addEventListener("click", search);
    document.getElementById("searchBox").addEventListener("keydown", (e) => {
      if (e.key === "Enter") search();
    });

    // Start
    loadIndex();
  </script>
</body>
</html>


