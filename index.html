<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SV IT Site</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    
    body {background:linear-gradient(180deg, #ffeef1, #ffc6d0, #fdcffd); width:100%; min-height:100vh; padding:0px; margin: 0px; text-align:center;}
    html {width:100%; min-height:100vh;}
    a {color:blue; text-decoration: none;}
    #main-content{width:100%; min-height:calc(100vh - 41px);}
    h1 { margin-bottom: 12px; }
    .row { display: flex; gap: 8px; justify-content: center; }
    input { padding: 10px; font-size: 16px; width: 260px; }
    button { padding: 10px 14px; font-size: 16px; cursor: pointer; background: #03A9F4; color: #fff;  font-weight: 800; border: 1px solid #000;}
    #status { margin-top: 8px; font-size: 14px; color: #555; }
    #result { margin-top: 18px; }
    .link { display: block; margin: 16px 0; padding: 10px 0px; color: #0000ff; font-weight: 800; font-size: 18px;}
    .error { color: #b00020; }
    .muted { color: #666; font-size: 14px; }
   marquee {background:#d46ee5; color:#fff; padding:4px; font-weight:800; font-size:26px;}
    @media screen and (max-width:800px){
.row {display:flex; flex-direction: column; align-items: center; padding: 10px 5px;}
#searchBox{display:block;}
#searchBtn{display:block; width: 100px;}
}
    #hide {display:none;}
    #searchBtn:hover {background:#d46ee5;}
    #footer {display:block; background:#000; color:#fff; font-size:18px; padding:10px; text-align:right;}
  </style>
</head>
<body>

<div id='main-content'>

<marquee behavior="alternate" scrollamount="8">You Can Download Paper Cutting from Tender Notice No. <span style='color:#0000ff'>S-01-2024 </span>to <span style='color:#0000ff'>S-58-2025</span> dated:-03.09.2025</marquee>

  
  <h1>Download Paper Cutting by 8-digit Tender Number</h1>
  <div class="row">
    <input id="searchBox" type="text" inputmode="numeric" maxlength="8" placeholder="Enter 8-digit number" />
    <button id="searchBtn">Search</button>
  </div>
  <div id="status" class="muted">Loading indexâ€¦</div>
  <div id="result"></div>


<div id='hide'><img href='https://raw.githubusercontent.com/svsection/papercutting/refs/heads/main/logo.webp'/></div>



 </div>


<div id='footer'>Developed By: SV Section Stores Deptt WR HQ</div>
 
  <script>
    // Reverse index: "12345678" -> Set([ "Paper Cutting S-01-2025.pdf", ... ])
    const reverseIndex = new Map();
    let indexReady = false;

    // Helper: make sure values from JSON become 8-char digit strings
    function toEightDigitString(n) {
      if (n === null || n === undefined) return null;
      let s = String(n).trim();         // handle numbers or strings
      s = s.replace(/\D/g, "");         // keep digits only
      if (s.length === 0) return null;
      if (s.length > 8) return null;    // ignore anything that's not exactly 8 digits
      if (s.length < 8) s = s.padStart(8, "0");
      return /^\d{8}$/.test(s) ? s : null;
    }

    function buildReverseIndex(indexData) {
      for (const [file, nums] of Object.entries(indexData)) {
        if (!Array.isArray(nums)) continue;
        for (const n of nums) {
          const key = toEightDigitString(n);
          if (!key) continue;
          if (!reverseIndex.has(key)) reverseIndex.set(key, new Set());
          reverseIndex.get(key).add(file);
        }
      }
    }

    async function loadIndex() {
      const status = document.getElementById("status");
      try {
        const res = await fetch("index.json", { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        buildReverseIndex(data);
        indexReady = true;
        status.textContent = "Welcome, Have a good day...";
      } catch (e) {
        indexReady = false;
        status.innerHTML = `<span class="error">Couldn't load index.json (${e.message}).</span>`;
      }
    }

    function search() {
      const resultDiv = document.getElementById("result");
      const status = document.getElementById("status");
      const query = document.getElementById("searchBox").value.trim();

      resultDiv.innerHTML = "";

      if (!indexReady) {
        status.innerHTML = `<span class="error">Index not ready yet. Please wait a moment.</span>`;
        return;
      }

      if (!/^\d{8}$/.test(query)) {
        resultDiv.innerHTML = `<p class="error">Please enter a valid 8-digit number.</p>`;
        return;
      }

      const filesSet = reverseIndex.get(query);
      if (filesSet && filesSet.size > 0) {
        const files = Array.from(filesSet).sort((a, b) => a.localeCompare(b, undefined, { numeric: true }));
        const header = document.createElement("p");
        header.textContent = `Found in ${files.length} PDF${files.length > 1 ? "s" : ""}:`;
        resultDiv.appendChild(header);

        for (const pdf of files) {
          const a = document.createElement("a");
          a.className = "link";
          a.href = "pdfs/" + encodeURIComponent(pdf); // handle spaces & special chars
          a.target = "_blank";
          a.download = pdf;
          a.textContent = pdf; // show actual filename
          resultDiv.appendChild(a);
        }
      } else {
        resultDiv.innerHTML = `<p class="error">Paper Cutting Yet to be received in SV Section</p>`;
      }
    }

    // Wire up UI
    document.getElementById("searchBtn").addEventListener("click", search);
    document.getElementById("searchBox").addEventListener("keydown", (e) => {
      if (e.key === "Enter") search();
    });

    // Start
    loadIndex();
  </script>
</body>
</html>























